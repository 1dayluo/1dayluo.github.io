
<!DOCTYPE html>
<html>
  <head>
    
<meta charset="utf-8" >

<title>Struts2 s2-001 å­¦ä¹ ç¬”è®° | æŒå‰‘</title>
<meta name="description" content="ç¢æœˆæ˜Ÿè¾°æ½æ±Ÿé£ , æˆ‘å¿ƒæœ‰å‰‘é—®å¤©æ¶¯ ">

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
<link rel="shortcut icon" href="https://1dayluo.github.io/favicon.ico?v=1711284755357">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
<link rel="stylesheet" href="https://1dayluo.github.io/styles/main.css">



<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.5.1/build/highlight.min.js"></script>



  </head>
  <body>
    <div id="app" class="main">
      <div class="site-header-container">
  <div class="site-header">
    <div class="left">
      <a href="https://1dayluo.github.io">
        <img class="avatar" src="https://1dayluo.github.io/images/avatar.png?v=1711284755357" alt="" width="32px" height="32px">
      </a>
      <a href="https://1dayluo.github.io">
        <h1 class="site-title">æŒå‰‘</h1>
      </a>
    </div>
    <div class="right">
      <transition name="fade">
        <i class="icon" :class="{ 'icon-close-outline': menuVisible, 'icon-menu-outline': !menuVisible }" @click="menuVisible = !menuVisible"></i>
      </transition>
    </div>
  </div>
</div>

<transition name="fade">
  <div class="menu-container" style="display: none;" v-show="menuVisible">
    <div class="menu-list">
      
        
          <a href="/" class="menu purple-link">
            é¦–é¡µ
          </a>
        
      
        
          <a href="/archives" class="menu purple-link">
            å½’æ¡£
          </a>
        
      
        
          <a href="/tags" class="menu purple-link">
            æ ‡ç­¾
          </a>
        
      
        
          <a href="/post/about" class="menu purple-link">
            å…³äº
          </a>
        
      
    </div>
  </div>
</transition>


      <div class="content-container">
        <div class="post-detail">
          
          <h2 class="post-title">Struts2 s2-001 å­¦ä¹ ç¬”è®°</h2>
          <div class="post-info post-detail-info">
            <span><i class="icon-calendar-outline"></i> 2022-04-09</span>
            
              <span>
                <i class="icon-pricetags-outline"></i>
                
                  <a href="https://1dayluo.github.io/tag/ZYt2rq1nxl/">
                    ç¬”è®°
                    
                      ï¼Œ
                    
                  </a>
                
                  <a href="https://1dayluo.github.io/tag/ixnl6xCyBJ/">
                    javaæ¼æ´
                    
                  </a>
                
              </span>
            
          </div>
          <div class="post-content" v-pre>
            <h1 id="struts2-s2-001-å­¦ä¹ ç¬”è®°">Struts2 s2-001 å­¦ä¹ ç¬”è®°</h1>
<p>notioné˜…è¯»ç‰ˆ:https://cubic-brace-c93.notion.site/Struts2-s2-001-1629a6906fba4d7f96659221cff4481a</p>
<p>å¸Œæœ›æˆ‘çš„å­¦ä¹ ç»éªŒèƒ½å¯¹å’Œæˆ‘ä¸€æ ·æƒ³å…¥é—¨çš„javaå°ç™½èµ·åˆ°å¸®åŠ©~</p>
<h2 id="éƒ¨ç½²è°ƒè¯•">éƒ¨ç½²&amp;è°ƒè¯•</h2>
<aside>
ğŸ’¡ éœ€è¦æå‰é…å¥½IDEAä¸‹è½½jarä¾èµ–ï¼šFile -> Setting ->Maven ->Importingï¼šé€‰ä¸­Automatically downloadä¸­çš„ä¸¤ä¸ªå¤šé€‰æ¡†Sourceså’ŒDocumentation
</aside>
<p>â—å¤‡æ³¨ï¼šå‰ä¸¤ç§remoteåŠdockeréƒ¨ç½²æ–¹å¼æœ‰å‘ï¼Œå°šæœªè§£å†³</p>
<h3 id="éƒ¨ç½²æ¼æ´ç¯å¢ƒ">éƒ¨ç½²æ¼æ´ç¯å¢ƒ</h3>
<p>æˆ‘ä½¿ç”¨vulhubï¼Œåˆ°struts2ç›®å½•ä¸‹ <code>docker-compose up -d</code></p>
<p>è°ƒè¯•æˆ‘ä½¿ç”¨çš„IDEAï¼Œç¬¬ä¸€æ¬¡ä½¿ç”¨è¿™ä¸ªå·¥å…·ï¼Œä¸æ˜¯å¾ˆç†Ÿæ‚‰ã€‚åšäº†ä¸€äº›ç¬”è®°ã€‚</p>
<h3 id="æ™®é€šè¿œç¨‹è°ƒè¯•">æ™®é€šè¿œç¨‹è°ƒè¯•</h3>
<p><strong>ç›´æ¥configurationåˆ›å»ºremote</strong></p>
<p>è¿œç¨‹è°ƒè¯•çš„æ¡ä»¶:</p>
<ol>
<li>æœ¬åœ°éœ€è¦æ‹¥æœ‰ä»£ç æ–‡ä»¶ï¼ˆæ³¨æ„libä¸‹çš„jaræ–‡ä»¶éœ€è¦å¯¼å…¥ï¼‰</li>
<li>è¿œç¨‹javaç‰ˆæœ¬ä¸project Structureå†…çš„javaç‰ˆæœ¬ä¿æŒä¸€è‡´</li>
<li>ä¿®æ”¹javaç¨‹åºå¯åŠ¨å‘½ä»¤ï¼Œå¢åŠ è°ƒè¯•æ”¯æŒ</li>
</ol>
<p>å¦‚æœæ˜¯dockerå†…éƒ¨çš„è¿˜éœ€è¦ï¼š</p>
<ol>
<li>å¼€æ”¾è°ƒè¯•ç«¯å£</li>
<li>dockerä¸­æ‹–å‡ºçš„classæˆ–jaræ·»åŠ ä¸ºåº“ï¼ˆï¼Ÿ</li>
<li>æŸ¥çœ‹å¯åŠ¨å‘½ä»¤ï¼šè¿›å…¥dockerå®¹å™¨ï¼Œä½¿ç”¨ <code>ps</code> ç­‰æ‰¾åˆ°javaç¨‹åºå¯åŠ¨æ–¹æ³•ã€‚æˆ–è€…ä½¿ç”¨ <code>docker-compose up -d</code> åä½¿ç”¨ <code>docker ps --no-trunc</code> æŸ¥çœ‹é»˜è®¤å¯åŠ¨å‘½ä»¤</li>
<li>ä¿®æ”¹å¯åŠ¨å¯¹åº”dockeré…ç½®</li>
</ol>
<p>è¿™ä¸ªå­æ ‡é¢˜ä¸‹æˆ‘çš„å‚è€ƒ/ç¬”è®°ï¼š</p>
<blockquote>
<p>ä¸€ç¯‡ä¸é”™çš„åšæ–‡<br>
<a href="https://ares-x.com/2020/04/20/IDEA%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95Docker%E4%B8%AD%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%96%B9%E6%B3%95/">https://ares-x.com/2020/04/20/IDEAè¿œç¨‹è°ƒè¯•Dockerä¸­ç¨‹åºçš„æ–¹æ³•/</a></p>
</blockquote>
<h3 id="è¡¥å……å…³äºdockeré•œåƒè°ƒè¯•">è¡¥å……å…³äºï¼šDockeré•œåƒè°ƒè¯•</h3>
<p><strong>ç›´æ¥configurationåˆ›å»ºdocker</strong></p>
<aside>
ğŸ’¡ **JAVA_TOOL_OPTIONS**:For Java versions prior to 8 the variable was calledÂ **JAVA_OPTS**
</aside>
<p>ä¹Ÿå¯ä»¥ç›´æ¥IDEAè¿dockeré•œåƒè°ƒè¯•ï¼ˆéœ€è¦æœ¬åœ°æœ‰ä»£ç +dockerfileï¼‰</p>
<ul>
<li>å¼€æ”¾è¿œç¨‹è°ƒè¯•ç«¯å£</li>
<li>é…ç½®ï¼šdockeræ–‡ä»¶è®¾ç½®å…è®¸JWDPï¼ˆ<em>Java Debug Wire Protocol</em><br>
ï¼‰çš„é€‰é¡¹,eg: <code>ENV JAVA_TOOL_OPTIONS -agentlib:jdwp=transport=dt_socket,address=8000,server=y,suspend=n</code></li>
</ul>
<p>ä»¥ä¸‹æ˜¯æˆ‘çš„å‚è€ƒ/ç¬”è®°</p>
<blockquote>
<p>ä¸€ä»½å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://www.jetbrains.com/help/idea/docker.html#interacting-with-containers">https://www.jetbrains.com/help/idea/docker.html#interacting-with-containers</a><br>
ä¸€ç¯‡ä¸é”™çš„åšæ–‡ï¼š<br>
<a href="https://medium.com/swlh/remote-debugging-a-java-application-running-in-docker-container-with-intellij-idea-efe54cd77f02">https://medium.com/swlh/remote-debugging-a-java-application-running-in-docker-container-with-intellij-idea-efe54cd77f02</a></p>
</blockquote>
<h3 id="æœ¬åœ°è°ƒè¯•">æœ¬åœ°è°ƒè¯•</h3>
<p>éœ€è¦åœ¨æœ¬åœ°å®‰è£…tomcatï¼Œç„¶åconfigurationæ·»åŠ tomcatï¼Œé€‰æ‹©tomcat server</p>
<p>è¦æ³¨æ„çš„ä¸€äº›é…ç½®ï¼š</p>
<ul>
<li>java versionï¼š1.8</li>
<li>IDEAéœ€è¦æå‰é…ç½®å¥½Tomcatå’ŒMavenç¯å¢ƒ</li>
<li>Configurationé€‰æ‹©è‡ªå·±æœ¬åœ°çš„tomcatè·¯å¾„</li>
<li>tldæ–‡ä»¶å¦‚æœæ²¡æœ‰è¢«è¯†åˆ«å‡ºæ¥ï¼Œéœ€è¦é…ç½®tomcatä¸‹çš„ <code>[catalin.properties](http://catalin.properties)</code> (æ–‡ç« ç‚¹å‡»<a href="https://blog.nowcoder.net/n/0f9f61f7a722490d9ac157adca1803d2">è¿™é‡Œ</a>ï¼‰å¦‚æœæ²¡æœ‰ç”Ÿæ•ˆ(çœ‹<a href="https://blog.chiyu.monster/?p=83">è¿™ç¯‡</a>æ–‡ç« ï¼‰ï¼Œéœ€è¦è§£å‹ç¼©æ–‡ä»¶å¹¶é…ç½®web.xml</li>
</ul>
<p>æ­¥éª¤/è¸©çš„å‘ï¼š</p>
<ol>
<li>File -&gt; Project Structure è®¾ç½® Project SDK</li>
<li>Modules â†’ Import Module æŠŠç›®å½•ä»¥Maven Moduleæ¥æ·»åŠ </li>
<li>Modules â†’ é€‰æ‹©åˆšåˆ›å»ºçš„Moduleï¼Œæ–°å»º <code>Framework</code> ä¸‹çš„web</li>
<li>configuration tomcat â†’ Deployment â†’ æ·»åŠ Artifacts</li>
</ol>
<p>è™½ç„¶è¸©äº†å‘ ä½†æ˜¯æœ€åç»ˆäºè§£å†³äº†ğŸ¥² debugå¥½è€¶</p>
<p>å‚è€ƒï¼š</p>
<blockquote>
<p><a href="https://cloud.tencent.com/developer/article/1598043">https://cloud.tencent.com/developer/article/1598043</a><br>
è¿™ä¸ªç›¸å¯¹å…¨è€Œä¸”æ˜¯é’ˆå¯¹Struts2çš„<br>
<a href="https://kingx.me/Struts2-S2-052.html">https://kingx.me/Struts2-S2-052.html</a><br>
å¦‚æœç¯å¢ƒæœ‰é—®é¢˜çœ‹è¿™ç¯‡æ–‡ç« å‚è€ƒç»†èŠ‚ï¼š<br>
<a href="https://www.jianshu.com/p/a787a3689d68">https://www.jianshu.com/p/a787a3689d68</a></p>
</blockquote>
<h2 id="å°ç™½å­¦åŸºç¡€">å°ç™½å­¦åŸºç¡€</h2>
<h3 id="åŸºç¡€å…³äºç›®å½•">åŸºç¡€ï¼šå…³äºç›®å½•</h3>
<ul>
<li>javawebä¸‹WEB-INFç›®å½•ï¼šæ˜¯javawebçš„å®‰å…¨ç›®å½•ï¼ˆåªæœ‰æœåŠ¡ç«¯èƒ½å¤Ÿè®¿é—®ï¼‰
<ul>
<li>WEB-INF/classesï¼šæºä»£ç ä½ç½®</li>
<li>WEB-INF/lib: å­˜æ”¾éœ€è¦çš„jaræ–‡ä»¶ï¼Œä¾‹å¦‚æ•°æ®åº“é©±åŠ¨</li>
<li>META-INFï¼šåœ¨ç”¨jaræ‰“åŒ…æ—¶è‡ªåŠ¨ç”Ÿæˆ</li>
</ul>
</li>
</ul>
<h3 id="åŸºç¡€tld">åŸºç¡€ï¼štld</h3>
<p>å­¦ä¹ å¤§çº²</p>
<ol>
<li>ä»€ä¹ˆæ˜¯tldæ–‡ä»¶</li>
<li>tldæ–‡ä»¶ç»“æ„ï¼Œä»¥åŠ<tag-class>ï¼Œ<short-name></li>
<li>tldæ–‡ä»¶åœ¨jspæ–‡ä»¶ä¸­çš„å¯¹åº”ï¼Œuriï¼Œè‡ªå®šä¹‰æ ‡ç­¾ï¼ˆshort-name)</li>
<li>é’ˆå¯¹<tag-class>ï¼Œå¯¹åº”çš„æ ‡ç­¾å¤„ç†ç±»ï¼š <code>TagSupport</code> , <code>BodyTagSupport</code></li>
<li>ç»§æ‰¿ <code>TagSupport</code> æˆ– <code>BodyTagSupport</code> åè¦é‡å†™çš„æ–¹æ³•
<ol>
<li><code>TagSupport</code> : <em>doStartTag</em>,å¤„ç†<strong>å¤´æ ‡ç­¾</strong>ï¼Œè¿”å›int ï¼ˆå¯ä»¥åœ¨è¿™é‡Œæ„é€ å°†è¦è¾“å‡ºåˆ°é¡µé¢çš„ä»£ç ï¼‰
<ol>
<li>ä¸º <code>EVAL_BODY_INCLUDE</code> ï¼ˆ1ï¼‰ æ—¶ï¼šæ­£å¸¸åŠ è½½æ ‡ç­¾çš„body</li>
<li>ä¸º <code>SKIP_BODY</code> (0) æ—¶ï¼š ä¸ä¼šåŠ è½½æ ‡ç­¾ï¼Œè¿”å›åæ‰§è¡Œ <code>doEndTag()</code> æ–¹æ³•</li>
<li>ä¸º <code>EVAL_BODY_BUFFERED</code> ï¼ˆ2ï¼‰æ—¶ï¼šå°½åœ¨å¤„ç†ç±»ç»§æ‰¿äº† <code>BodyTagSupport</code> æ—¶å¯ä»¥ä½¿ç”¨ï¼Œè¿”å›åjavaæ„é€  <code>BodyContent</code> å¯¹è±¡ï¼ŒæŠŠæ ‡ç­¾çš„bodyè½½å…¥è¿™ä¸ªå¯¹è±¡</li>
</ol>
</li>
<li><code>TagSupport</code> : <em>doEndTag</em>,å¤„ç†<strong>å°¾æ ‡ç­¾</strong>ï¼Œè¿”å›intï¼ˆä¹Ÿå¯ä»¥åœ¨è¿™é‡Œæ„é€ å°†è¦è¾“å‡ºåˆ°é¡µé¢çš„ä»£ç ï¼‰
<ol>
<li>ä¸º <code>EVAL_PAGE</code>  (6) ,è¿”å›è¡¨ç¤ºåŠ è½½æ­¤æ ‡ç­¾ä¹‹åçš„é¡µé¢ä»£ç </li>
<li>ä¸º <code>SPKIP_PAGE</code> (5),è¿”å›è¡¨ç¤ºä¸å†ç»§ç»­åŠ è½½æ­¤æ ‡ç­¾ä¹‹åçš„é¡µé¢ä»£ç ï¼Œç›´æ¥å°†å·²å¤„ç†å®Œå‘é€å®¢æˆ·ç«¯</li>
</ol>
</li>
<li><code>TagSupport</code> : <em>doAfterTag</em>,è¿”å›int ï¼ˆ <code>doStartTag</code> è¿”å› <code>EVAL_BODY_INCLUDE</code> &amp;&amp; åŠ è½½å®Œæ ‡ç­¾çš„body ååŠ è½½ï¼‰
<ol>
<li>ä¸º <code>EVAL_BODY_AGAIN</code> (5) å†ä¸€æ¬¡åŠ è½½bodyä¹‹åä¼šæ‰§è¡Œ</li>
<li>ä¸º <code>SKIP_BODY</code> åŒ <em>doStartTag</em></li>
</ol>
</li>
<li><code>BodyTagSupport</code> : doInitBody,æ²¡æœ‰ä»£ç ,æ²¡æœ‰è¿”å›å€¼</li>
</ol>
</li>
<li><strong>æ˜¯å¦èƒ½ä¿®æ”¹bodyæ˜¯ <code>BodyTagSupport</code> å’Œ <code>TagSupport</code> æœ€å¤§çš„åŒºåˆ«</strong></li>
<li>ä½¿ç”¨è‡ªå®šä¹‰æ ‡ç­¾</li>
</ol>
<p>å…³äºtldä¸‹å¤„ç†tag-classç±»ä¸‹æ–¹æ³•çš„è°ƒç”¨é¡ºåºçš„å›¾ä¾‹:</p>
<figure data-type="image" tabindex="1"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_00.png" alt="Untitled" loading="lazy"></figure>
<p>å‚è€ƒå­¦ä¹ çš„æ–‡ç« ï¼š</p>
<blockquote>
<p>ã€Š<strong><strong>ä½¿ç”¨ tld æ–‡ä»¶è‡ªå®šä¹‰ jsp æ ‡ç­¾åº“_lkforce</strong></strong>ã€‹<br>
<a href="https://blog.csdn.net/lkforce/article/details/85003068">https://blog.csdn.net/lkforce/article/details/85003068</a></p>
</blockquote>
<h3 id="åŸºç¡€ä½¿ç”¨mavenè¿›è¡Œä¾èµ–ç®¡ç†">åŸºç¡€ï¼šä½¿ç”¨mavenè¿›è¡Œä¾èµ–ç®¡ç†</h3>
<ul>
<li>å…ˆé…ç½®IDEAä½¿ç”¨mavenè‡ªåŠ¨ä¸‹è½½ä¾èµ–ï¼š
<ul>
<li><code>File -&gt; Setting -&gt;Maven -&gt;Importing</code>ï¼šé€‰ä¸­ <code>Automatically download</code>ä¸­çš„ä¸¤ä¸ªå¤šé€‰æ¡†Sourceså’ŒDocumentation</li>
</ul>
</li>
<li>ä½¿ç”¨å¿«æ·é”®ï¼ˆctrl+alt+shift+uï¼‰å¯ä»¥ä¸€è§ˆæ•´ä¸ªé¡¹ç›®çš„ä¾èµ–</li>
</ul>
<h3 id="åŸºç¡€è°ƒè¯•tips">åŸºç¡€ï¼šè°ƒè¯•Tips</h3>
<p>æŸ¥æ‰¾æ–¹æ³•ï¼š</p>
<p>ä½¿ç”¨ <code>ctrl+F12</code> å°±å¯ä»¥åœ¨å½“å‰ç±»ä¸­æŸ¥æ‰¾æ–¹æ³•å•¦~~</p>
<h3 id="åŸºç¡€å…³äºstruts2çš„altsyntaxç‰¹æ€§">åŸºç¡€:å…³äºStruts2çš„altSyntaxç‰¹æ€§</h3>
<aside>
ğŸ’¡ `altSyntax` ç‰¹æ€§æ˜¯é»˜è®¤å¼€å¯çš„
</aside>
<p>ä»€ä¹ˆæ˜¯ <code>altSyntax</code> ç‰¹æ€§ï¼Ÿ</p>
<p>å…è®¸è¡¨å•ä¸­æäº¤åŒ…å«OGNLè¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¼ˆé€šå¸¸é€šè¿‡æ–‡æœ¬å­—æ®µä¼ è¾¾ï¼Œä¾‹å¦‚ <code>&lt;s:textfile&gt;</code> ï¼‰ï¼Œä¸”å¯å¯¹åŒ…å«OGNLçš„è¡¨è¾¾å¼è¿›è¡Œé€’å½’è®¡ç®—</p>
<p><code>altSyntax</code> åœ¨å“ªé‡Œé…ç½®ï¼Ÿ</p>
<p>è¯¥å±æ€§è®¾ç½®åœ¨struts2æ–‡ä»¶çš„ <code>defaultproperties</code> ä¸­</p>
<h2 id="struts2-åˆ†æå®æˆ˜">Struts2 åˆ†æå®æˆ˜</h2>
<aside>
ğŸ’¡ éœ€è¦ä½¿ç”¨IDEAåœ¨è¦è°ƒè¯•çš„jaråŒ…å³é”®é€‰æ‹©â€Add as Libraryâ€œ
</aside>
<p>jspæ–‡ä»¶</p>
<pre><code class="language-jsx">&lt;%@ page language=&quot;java&quot; contentType=&quot;text/html; charset=UTF-8&quot;
    pageEncoding=&quot;UTF-8&quot;%&gt;
&lt;%@ taglib prefix=&quot;s&quot; uri=&quot;/struts-tags&quot; %&gt;
&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD HTML 4.01 Transitional//EN&quot; &quot;http://www.w3.org/TR/html4/loose.dtd&quot;&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;
&lt;title&gt;S2-001&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;h2&gt;S2-001 Demo&lt;/h2&gt;
&lt;p&gt;link: &lt;a href=&quot;https://struts.apache.org/docs/s2-001.html&quot;&gt;https://struts.apache.org/docs/s2-001.html&lt;/a&gt;&lt;/p&gt;

&lt;s:form action=&quot;login&quot;&gt;
	&lt;s:textfield name=&quot;username&quot; label=&quot;username&quot; /&gt;
	&lt;s:textfield name=&quot;password&quot; label=&quot;password&quot; /&gt;
	&lt;s:submit&gt;&lt;/s:submit&gt;
&lt;/s:form&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>ä½¿ç”¨äº†è‡ªå®šä¹‰æ ‡ç­¾textfieldï¼Œå¯ä»¥çœ‹åˆ°å¯¹åº”çš„æ ‡ç­¾æ˜¯ <code>textfield</code> ï¼ŒæŸ¥çœ‹å¯¹åº”çš„tldæ–‡ä»¶ä¸‹å“æ ‡ç­¾</p>
<p>å¯¹åº”çš„tldæ–‡ä»¶ä½äº <code>WEB-INF/lib/struts2-core-2.0.8.jar/META-INF/struts-tags/tld</code>  ä¸‹ï¼š</p>
<pre><code class="language-jsx">&lt;name&gt;textfield&lt;/name&gt;
&lt;tag-class&gt;org.apache.struts2.views.jsp.ui.TextFieldTag&lt;/tag-class&gt;
&lt;body-content&gt;JSP&lt;/body-content&gt;
&lt;description&gt;&lt;![CDATA[Render an HTML input field of type text]]&gt;&lt;/description&gt;
</code></pre>
<p>å¯¹åº” <code>label</code> å‚æ•°çš„åœ°æ–¹ï¼š</p>
<pre><code class="language-jsx">&lt;attribute&gt;
      &lt;name&gt;label&lt;/name&gt;
      &lt;required&gt;false&lt;/required&gt;
      &lt;rtexprvalue&gt;true&lt;/rtexprvalue&gt;
      &lt;description&gt;&lt;![CDATA[Label expression used for rendering a element specific label]]&gt;&lt;/description&gt;
&lt;/attribute&gt;
</code></pre>
<p>çœ‹tag-classæ ‡ç­¾ï¼ŒçŸ¥é“å¯¹åº”çš„æ ‡ç­¾å¤„ç†ç±»ä¸º <code>org.apache.struts2.views.jsp.ui.TextFieldTag</code> ã€‚</p>
<p>è¿™é‡ŒS2-001 äº§ç”Ÿé—®é¢˜çš„ä¸»è¦åŸå› åœ¨äºbodyåçš„å¤„ç†ç±»ä¸­ï¼Œå³ <code>doEndTag</code> .ç¬¬ä¸€æ¬¡å­¦ä¹ s2ï¼Œä¸ºäº†çŸ¥è¯†ç‚¹å…¨é¢ï¼Œæ‰€ä»¥é˜…è¯»äº†å¤šç¯‡æ–‡ç« ï¼Œä»¥ç»†ä¸ºä¸»ã€‚çœ‹æ¼æ´äº§ç”Ÿçš„åŸå› å¯ä»¥ç›´æ¥è°ƒh3:â€bodyåå¤„ç†ç±»â€œ</p>
<h3 id="bodyå‰å¤„ç†ç±»">bodyå‰å¤„ç†ç±»</h3>
<p>é’ˆå¯¹ä¹‹å‰tldç« èŠ‚çš„å­¦ä¹ å’Œè°ƒç”¨é¡ºåºçš„å­¦ä¹ ï¼ˆ<a href="https://www.notion.so/Struts2-s2-001-1629a6906fba4d7f96659221cff4481a">ç‚¹æ­¤</a>ï¼‰ï¼Œä¼šåœ¨bodyå‰æ‰§è¡Œ <code>doStartTag</code> æ–¹æ³•ï¼Œä½† <code>TextFieldTag</code> æ²¡æœ‰æ­¤æ–¹æ³•ï¼ŒæŸ¥çœ‹è°ƒç”¨é“¾</p>
<figure data-type="image" tabindex="2"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_01.png" alt="Untitled" loading="lazy"></figure>
<p>æœ€åè°ƒç”¨çš„ç‚¹æ˜¯ï¼š</p>
<p><code>org.apache.struts2.views.jsp.ComponentTagSupport#doStartTag</code></p>
<p>â—å¤‡æ³¨ï¼šè¿™é‡Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>ctrl+F12</code> æ¥è¿›è¡Œæœç´¢ <code>doStartTag</code>  å’Œ<code>doEndTag</code></p>
<p>æŸ¥çœ‹å¯¹åº”çš„ä»£ç ï¼š</p>
<pre><code class="language-jsx">public int doStartTag() throws JspException {
        this.component = this.getBean(this.getStack(), (HttpServletRequest)this.pageContext.getRequest(), (HttpServletResponse)this.pageContext.getResponse()); //è¿™é‡Œçš„componentå¯¹è±¡å®é™…ä¸Šæ˜¯TextFieldå¯¹è±¡
        Container container = Dispatcher.getInstance().getContainer();
        container.inject(this.component);
        this.populateParams(); #ç”¨äºåˆå§‹åŒ–å±æ€§
        boolean evalBody = this.component.start(this.pageContext.getOut());
        if (evalBody) {
            return this.component.usesBody() ? 2 : 1;
        } else {
            return 0;
        }
    }
</code></pre>
<p>å…¶ä¸­ç”±äºTextFieldå¯¹è±¡æ²¡æœ‰å®ç°è¯¥æ–¹æ³•ï¼Œè€Œè°ƒç”¨é»˜è®¤æ–¹æ³•ï¼ˆ <code>org.apache.struts2.components.Component</code> )ä¸ºä¸‹å›¾çº¢æ¡†åœˆä½çš„åœ°æ–¹</p>
<figure data-type="image" tabindex="3"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_02.png" alt="Untitled" loading="lazy"></figure>
<p>å…¶ä¸­ï¼Œä¸­é—´çš„ <code>populateParams</code> ç”¨äºåˆå§‹åŒ–å±æ€§(è¿™é‡Œå®šä¹‰äº†doEndStartçš„ <code>value</code> ï¼‰</p>
<p>æœ€åé»˜è®¤æ–¹æ³• <code>this.component.useBody()</code> è¿”å›çš„æ˜¯ <code>false</code> ï¼Œæ‰€ä»¥ <code>doStartTag</code> è¿”å›çš„æ˜¯1ï¼Œå¯¹åº”çš„å¸¸é‡ä¸º <code>EVAL_BODY_INCLUDE</code></p>
<h3 id="bodyåå¤„ç†ç±»">bodyåå¤„ç†ç±»</h3>
<aside>
ğŸ’¡ breakpointsæ¥è¿›è¡Œæ–­ç‚¹ç®¡ç†ï¼Œç›®çš„æ˜¯ä¸ºäº†ç»™ä¸€äº›ä¸­æ–­åŠ æ¡ä»¶å‰æã€‚å¿«æ·é”® ctrl+shift+F8
</aside>
<p>å¦‚å›¾ <code>TextFieldTag</code> æ²¡æœ‰å®ç° <code>doEndTag</code> çš„æ–¹æ³•ï¼Œæ‰€ä»¥è¿˜æ˜¯è°ƒç”¨çš„é»˜è®¤æ–¹æ³•ã€‚</p>
<figure data-type="image" tabindex="4"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_03.png" alt="Untitled" loading="lazy"></figure>
<p>å¯¹åº”çš„é»˜è®¤æ–¹æ³•ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="language-jsx">public int doEndTag() throws JspException {
        this.component.end(this.pageContext.getOut(), this.getBody());
        this.component = null;
        return 6;
    }
</code></pre>
<p>è·Ÿè¿› <code>this.component.end</code></p>
<p>å¤‡æ³¨ï¼šIDEAè¿™é‡Œè°ƒè¯•æ¨¡å¼ä¸‹ç”¨ <code>F7</code> è·Ÿè¿›ï¼Œ ä¸ç„¶éè°ƒè¯•æ¨¡å¼ä¸‹æŒ‰ <code>ctrl</code> æ²¡æ³•è·Ÿè¿›åˆ°å¯¹åº”ç±»ä¸‹çš„ <code>end</code> æ–¹æ³•</p>
<p>å…¶ä¸­ï¼Œè§£æ <code>%{name}</code> è¡¨è¾¾å¼çš„å‡½æ•°æ˜¯ <code>protected Object findValue(String expr, Class toType)</code></p>
<pre><code class="language-jsx">if (this.altSyntax() &amp;&amp; toType == String.class) { // æ»¡è¶³æ¡ä»¶1 ï¼Œè¿›å…¥ifè¯­å¥
            return TextParseUtil.translateVariables('%', expr, this.stack);
        } else {
            if (this.altSyntax() &amp;&amp; expr.startsWith(&quot;%{&quot;) &amp;&amp; expr.endsWith(&quot;}&quot;)) {
                expr = expr.substring(2, expr.length() - 1);
            }

            return this.getStack().findValue(expr, toType);
        }
    }
altSyntaxæ–¹æ³•
</code></pre>
<p>å…¶ä¸­ <code>this.altSyntax</code> åæ˜ äº†struts2ä¸‹åä¸º<code>altSyntax</code>çš„ç‰¹æ€§ï¼Œè¯¥ç‰¹æ€§å…è®¸åœ¨è¡¨å•ä¸­æäº¤OGNLè¡¨è¾¾å¼çš„å­—ç¬¦ä¸²ï¼ˆç‚¹å‡»<a href="https://www.notion.so/Struts2-s2-001-1629a6906fba4d7f96659221cff4481a">è¿™é‡Œ</a>æŸ¥çœ‹æœ‰å…³åŸºç¡€ï¼‰</p>
<p>è·Ÿè¿› <code>findValue</code> ä¸‹çš„ <code>TextParseUtil.translateVariables</code></p>
<p>ï¼ˆs2-001 é—®é¢˜æ ¸å¿ƒåœ¨ <code>translateVariables</code> ä¸­ï¼‰</p>
<pre><code class="language-jsx">while(true) {
            int start = expression.indexOf(open + &quot;{&quot;);
            int length = expression.length();
            int x = start + 2;
            int count = 1;

            while(start != -1 &amp;&amp; x &lt; length &amp;&amp; count != 0) {
                char c = expression.charAt(x++);
                if (c == '{') {
                    ++count;
                } else if (c == '}') {
                    --count;
                }
            }

            int end = x - 1; //end ä¸º}å‰çš„ä½ç½®
            if (start == -1 || end == -1 || count != 0) {
                return XWorkConverter.getInstance().convertValue(stack.getContext(), result, asType);
            }

            String var = expression.substring(start + 2, end); // varè¿™é‡Œä¸º{ å’Œ } ä¹‹é—´çš„å†…å®¹
            Object o = stack.findValue(var, asType);  // è¿™é‡Œè¦è·Ÿè¿›
            if (evaluator != null) {
                o = evaluator.evaluate(o);
            }

            String left = expression.substring(0, start);
            String right = expression.substring(end + 1);
            if (o != null) {
                if (TextUtils.stringSet(left)) {
                    result = left + o;
                } else {
                    result = o;
                }

                if (TextUtils.stringSet(right)) {
                    result = result + right;
                }

                expression = left + o + right;
            } else {
                result = left + right;
                expression = left + right;
            }
        }
    }
</code></pre>
<p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼ˆå…³é”®éƒ¨åˆ†å·²åŠ å¤‡æ³¨ï¼‰ï¼Œæˆ‘ä»¬å†æ¥ç€è·Ÿè¿› <code>doEndTag</code> â†’ <code>end</code> â†’ <code>translateVariables</code>  â†’ <code>findValue</code></p>
<p>findValueçš„ä»£ç </p>
<pre><code class="language-jsx">com.opensymphony.xwork2.util.OgnlValueStack#findValue
public Object findValue(String expr, Class asType) {
        Object var4;
        try {
            Object value;
            if (expr != null) {
                if (this.overrides != null &amp;&amp; this.overrides.containsKey(expr)) {
                    expr = (String)this.overrides.get(expr);
                }

                value = OgnlUtil.getValue(expr, this.context, this.root, asType); //è·å–value
                if (value != null) {
                    var4 = value;
                    return var4;
                }

                var4 = this.findInContext(expr);
                return var4;
            }

            value = null;
            return value;
        } catch (OgnlException var9) {
            var4 = this.findInContext(expr);
        } catch (Exception var10) {
            this.logLookupFailure(expr, var10);
            var4 = this.findInContext(expr);
            return var4;
        } finally {
            OgnlContextState.clear(this.context);
        }

        return var4;
    }
</code></pre>
<p>å…¶ä¸­ä¼ å…¥ <code>findValue</code> çš„ï¼š</p>
<ul>
<li>å‚æ•°1 ä¸º<code>var</code> ï¼Œå˜é‡å€¼ä¸º <code>%{exp}</code> å†…çš„è¡¨è¾¾å¼</li>
<li>å‚æ•°2ä¸º <code>asType</code> , å€¼ä¸º <code>String.class</code></li>
</ul>
<p>å…³é”®åœ¨äºä»£ç ä¸­ <code>Ogn1Util.getValue(expr, this.context, this.root, asType)</code></p>
<p>è·Ÿè¿›  <code>doEndTag</code> â†’ <code>end</code> â†’ <code>translateVariables</code>  â†’ <code>findValue</code> â†’ <code>getValue</code></p>
<pre><code class="language-jsx">com.opensymphony.xwork2.util.OgnlUtil#getValue
public static Object getValue(String name, Map context, Object root, Class resultType) throws OgnlException {
        return Ognl.getValue(compile(name), context, root, resultType); // exprç¼–è¯‘ä¸ºä¸€ä¸ªAST Tree
    }

ognl.Ognl#getValue
public static Object getValue(Object tree, Map context, Object root, Class resultType) throws OgnlException {
        OgnlContext ognlContext = (OgnlContext)addDefaultContext(root, context);
        Object result = ((Node)tree).getValue(ognlContext, root);//è°ƒç”¨äº†AST Treeçš„æ–¹æ³•
        if (resultType != null) {
            result = getTypeConverter(context).convertValue(context, root, (Member)null, (String)null, result, resultType);
        }

        return result;
    }
</code></pre>
<p>è¿™é‡Œä¼šæŠŠexprç¼–è¯‘ä¸ºä¸€ä¸ªAST Treeï¼Œä¸”åœ¨ <code>Object result = ((Node)tree).getValue(ognlContext, root);</code> è¿™è¡Œä¸­è°ƒç”¨äº†AST Treeçš„ <code>getValue</code> æ–¹æ³•ï¼Œå¹¶ä¼ å…¥äº†ognlè¡¨è¾¾å¼</p>
<h3 id="å‚è€ƒè¡¥å……">å‚è€ƒ&amp;è¡¥å……</h3>
<p>å‚è€ƒåŠè¡¥å……ï¼š</p>
<blockquote>
<p>åˆ†æçš„çŸ¥è¯†å­¦ä¹ çš„è¿™ä½å¸ˆå‚…çš„æ–‡ç« ã€Šå®‰å…¨å®¢çš„Struts2 s2-001çš„åˆ†æã€‹<br>
<a href="https://www.anquanke.com/post/id/254808#h2-2">https://www.anquanke.com/post/id/254808#h2-2</a><br>
Apache Struts 2 Wiki(solution):<br>
<a href="https://cwiki.apache.org/confluence/display/WW/S2-001">https://cwiki.apache.org/confluence/display/WW/S2-001</a><br>
ç¬¬äºŒéé˜…è¯»å­¦ä¹ æ—¶è®¡åˆ’å‚è€ƒçš„æ–‡ç« ï¼š<br>
<a href="https://blog.csdn.net/mole_exp/article/details/122550317">https://blog.csdn.net/mole_exp/article/details/122550317</a></p>
</blockquote>
<h2 id="è°ƒè¯•å®æˆ˜ä¸‹çš„ä¸€äº›å…¶ä»–ç¬”è®°">è°ƒè¯•å®æˆ˜ä¸‹çš„ä¸€äº›å…¶ä»–ç¬”è®°</h2>
<h3 id="ä½¿ç”¨è¡Œæ–­ç‚¹">ä½¿ç”¨è¡Œæ–­ç‚¹</h3>
<p>åœ¨ <code>evaluateParams</code> ä¸‹æ€»æ˜¯ä¸å°å¿ƒé”™è¿‡è°ƒè¯•ç‚¹ï¼Œäºæ˜¯æˆ‘åœ¨ <code>expr</code> è¿™é‡Œä½¿ç”¨ breakpoints å¢åŠ äº†è¡Œæ–­ç‚¹ï¼Œå¹¶åªæ•è· <code>username</code> ä¸‹çš„æˆªæ–­ã€‚</p>
<figure data-type="image" tabindex="5"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_04.png" alt="Untitled" loading="lazy"></figure>
<h3 id="å…³äºtranslatevariablesä¸‹è¸©çš„å‘">å…³äºtranslateVariablesä¸‹è¸©çš„å‘</h3>
<p>è¿˜æœ‰è¿™é‡Œï¼Œå¿…é¡»è¦ <code>force step into</code> ï¼ˆalt+shift+F7ï¼‰ï¼Œåªæ˜¯ <code>step into</code> æ˜¯è¿›ä¸å»çš„</p>
<figure data-type="image" tabindex="6"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_05.png" alt="Untitled" loading="lazy"></figure>
<h3 id="ast-treeå¤„getvalueå¤„çš„åˆ†æ">AST Treeå¤„ï¼ˆgetValue)å¤„çš„åˆ†æ</h3>
<figure data-type="image" tabindex="7"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_06.png" alt="Untitled" loading="lazy"></figure>
<p>åœ¨ <code>ognl.Ognl.getValue</code> ä¸‹çœ‹åˆ°treeè¢«åˆå§‹åŒ–ä¸º</p>
<figure data-type="image" tabindex="8"><img src="https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/20220409a_07.png" alt="Untitled" loading="lazy"></figure>
<p>è¿™é‡Œresultä¼šè¢«èµ‹å€¼ä¸ºè®¡ç®—åçš„å€¼</p>
<p>å‚è€ƒ</p>
<blockquote>
<p>è°ƒè¯•æ•™ç¨‹æ¨èï¼š<br>
<a href="https://www.aneasystone.com/archives/2017/09/java-debugging.html">https://www.aneasystone.com/archives/2017/09/java-debugging.html</a></p>
</blockquote>
<h2 id="å…¶å®ƒreference">å…¶å®ƒReference</h2>
<ul>
<li><a href="https://seaii-blog.com/index.php/2019/12/29/90.html">https://seaii-blog.com/index.php/2019/12/29/90.html</a> (Struts2æ¼æ´è°ƒè¯•ç¬”è®°)</li>
<li>å®‰å…¨å®¢å…³äºOGNLçš„å­¦ä¹ ï¼š <a href="https://www.anquanke.com/post/id/254808">https://www.anquanke.com/post/id/254808</a></li>
<li>å…ˆçŸ¥ä¸‹å…³äºOGNLçš„å­¦ä¹ ï¼š<a href="https://xz.aliyun.com/t/10482">https://xz.aliyun.com/t/10482</a></li>
</ul>
<p><a href="https://pentester.land/list-of-bug-bounty-writeups.html">https://pentester.land/list-of-bug-bounty-writeups.html</a></p>

          </div>
        </div>

        
          <div class="next-post">
            <a class="purple-link" href="https://1dayluo.github.io/post/lesslesszseanos-methodogygreatergreater-xue-xi-bi-ji/">
              <h3 class="post-title">
                ä¸‹ä¸€ç¯‡ï¼šã€Šzseano&#39;s methodogyã€‹å­¦ä¹ ç¬”è®°
              </h3>
            </a>
          </div>
          
      </div>

      

      <div class="site-footer">
  <div class="slogan">ç¢æœˆæ˜Ÿè¾°æ½æ±Ÿé£ , æˆ‘å¿ƒæœ‰å‰‘é—®å¤©æ¶¯ </div>
  <div class="social-container">
    
      
    
      
    
      
    
      
    
      
    
  </div>
   | <a class="rss" href="https://1dayluo.github.io/atom.xml" target="_blank">RSS</a>
</div>


    </div>
    <script type="application/javascript">

hljs.initHighlightingOnLoad()

var app = new Vue({
  el: '#app',
  data: {
    menuVisible: false,
  },
})

</script>




  </body>
</html>
