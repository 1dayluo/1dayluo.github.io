import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang-DRVqeRiY.js";import{a as h,p as r,o as m,c as _,w as n,f as p,k as f,r as a,g as e,h as t}from"./app-CzjF7NIc.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-17i98rOK.js";import"./YunCard.vue_vue_type_script_setup_true_lang-Da3dkqK-.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-BsneHNVS.js";import"./index-C7yU5XnD.js";const g=e("p",null,[t("学习自下的回答，本内容为阅读对应资料后的笔记和自己的理解： "),e("a",{href:"https://security.stackexchange.com/questions/48879/why-does-directory-traversal-attack-c0af-work",target:"_blank",rel:"noreferrer"},"Why does Directory traversal attack %C0%AF work?")],-1),b=e("h2",{id:"基础知识",tabindex:"-1"},[t("基础知识 "),e("a",{class:"header-anchor",href:"#基础知识","aria-label":'Permalink to "基础知识"'},"​")],-1),y=e("p",null,"bits：组成bytes，是最小的单位",-1),x=e("p",null,"bytes：由8个bits组成。",-1),k=e("h2",{id:"url编码",tabindex:"-1"},[t("URL编码 "),e("a",{class:"header-anchor",href:"#url编码","aria-label":'Permalink to "URL编码"'},"​")],-1),C=e("p",null,"URL编码-",-1),F=e("ul",null,[e("li",null,[t("也叫百分比编码（"),e("a",{href:"https://en.wikipedia.org/wiki/Percent-encoding",target:"_blank",rel:"noreferrer"},"https://en.wikipedia.org/wiki/Percent-encoding"),t("）")]),e("li",null,"组成：%xx ，其中x代表一个十六进制的数字，能代表0-255内的数字"),e("li",null,"%xx代表一个byte")],-1),U=e("p",null,"%C0%2F：对应十进制192 (1100 0000) 和175 (1010 1111),",-1),v=e("p",null,"%C0%AF：对应十进制的192 (1100 0000)和47 (0010 1111)",-1),A=e("h2",{id:"关于ascii",tabindex:"-1"},[t("关于ASCII "),e("a",{class:"header-anchor",href:"#关于ascii","aria-label":'Permalink to "关于ASCII"'},"​")],-1),$=e("p",null,"ASCII 定义了0-127下的byte代表的的符号",-1),I=e("p",null,"ASCII 的扩展：unicode编码，以允许特殊符号（for non-English writers）",-1),w=e("h2",{id:"unicode",tabindex:"-1"},[t("Unicode "),e("a",{class:"header-anchor",href:"#unicode","aria-label":'Permalink to "Unicode"'},"​")],-1),z=e("p",null,"Unicode下特殊字符被数字编码替代。",-1),T=e("p",null,"Unicode进入字节流需要：",-1),j=e("ul",null,[e("li",null,"UTF-8编码"),e("li",null,"ASCII in a single byte (8 bits 0-127)")],-1),S=e("p",null,"UTF-8编码下：",-1),P=e("p",null,"110x xxxx 代表2 bytes （values 在：128-2047）",-1),L=e("p",null,"1110 xxxx 代表3 bytes",-1),R=e("p",null,"1111 xxxx 代表4 bytes",-1),q=e("p",null,"在UTF-8对于2bytes的字符的格式定义见下图第二行：",-1),B=e("figure",null,[e("img",{src:"https://i.loli.net/2021/08/17/iaTwYUB7M8h3REn.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),N=e("p",null,"%C0%AF是在范围外的数字：%AF(0010 1111) 与格式10xxxxxx不符。所以%C0%AF应该在UTF-8中视为报错。然而UTF-8为了速度”快“的设计忽略了安全方面。所以有的库不会检查two-byte的编码的值是否在有效范围内（即使unicode标准禁止这个）。",-1),V=e("p",null,"许多网站并不检查第二个byte的首个bit是否是1，因为前一个byte已经表明了该字符有2byte的codepoint。",-1),D=e("p",null,[t("错误的解码会接受"),e("code",null,"110i jklm ??no pqrs"),t(" 作为有两个byte的codepoint，而忽视掉"),e("code",null,"10"),t("也是UTF-8的标准")],-1),E=e("p",null,[t("所以，现在我们知道了为什么"),e("code",null,"%C0%AF"),t("和"),e("code",null,"%C0%2F"),t("都能最终被unicode 解码器解码为符号"),e("code",null,"/"),t(" 的原因是跳过了合适的检查。")],-1),M=e("p",null,"至于为什么能够成功的实现目录遍历，通常是发生在过滤不当输入和解码unicode符号发生在服务器的不同层级。",-1),O=e("p",null,"如果，服务器提供文件并且完成解码 是在防止目录遍历的检查后的；或操作系统的差异有略不同的处理，攻击者就能够跳过过滤让攻击生效。",-1),ee={__name:"guan-yu-mu-lu-bian-li-lou-dong-zhong-fei-biao-zhun-bian-ma-c02f-he-c0af-jun-neng-dai-biao-qie-jun-zai-lou-dong-zhong-sheng-xiao-de-yuan-li-tan-suo",setup(Z,{expose:d}){const i=JSON.parse('{"title":" 关于目录遍历漏洞中，非标准编码%C0%2F和%C0%AF均能代表/，且均在漏洞中生效的原理探索","description":"","frontmatter":{"title":" 关于目录遍历漏洞中，非标准编码%C0%2F和%C0%AF均能代表/，且均在漏洞中生效的原理探索","date":"2021-08-17T12:47:40.000Z","tags":["编码","技术阅读","笔记"],"published":true,"hideInList":false,"feature":null,"isTop":false},"headers":[{"level":2,"title":"基础知识","slug":"基础知识","link":"#基础知识","children":[]},{"level":2,"title":"URL编码","slug":"url编码","link":"#url编码","children":[]},{"level":2,"title":"关于ASCII","slug":"关于ascii","link":"#关于ascii","children":[]},{"level":2,"title":"Unicode","slug":"unicode","link":"#unicode","children":[]}],"relativePath":"pages/posts/history/guan-yu-mu-lu-bian-li-lou-dong-zhong-fei-biao-zhun-bian-ma-c02f-he-c0af-jun-neng-dai-biao-qie-jun-zai-lou-dong-zhong-sheng-xiao-de-yuan-li-tan-suo.md","path":"/home/runner/work/1dayluo.github.io/1dayluo.github.io/pages/posts/history/guan-yu-mu-lu-bian-li-lou-dong-zhong-fei-biao-zhun-bian-ma-c02f-he-c0af-jun-neng-dai-biao-qie-jun-zai-lou-dong-zhong-sheng-xiao-de-yuan-li-tan-suo.md","lastUpdated":1714218709000}'),s=h(),l=i.frontmatter||{};return s.meta.frontmatter=Object.assign(s.meta.frontmatter||{},i.frontmatter||{}),r("pageData",i),r("valaxy:frontmatter",l),globalThis.$frontmatter=l,d({frontmatter:{title:" 关于目录遍历漏洞中，非标准编码%C0%2F和%C0%AF均能代表/，且均在漏洞中生效的原理探索",date:"2021-08-17T12:47:40.000Z",tags:["编码","技术阅读","笔记"],published:!0,hideInList:!1,feature:null,isTop:!1}}),(o,W)=>{const u=c;return m(),_(u,{frontmatter:p(l)},{"main-content-md":n(()=>[g,b,y,x,k,C,F,U,v,f(" more "),A,$,I,w,z,T,j,S,P,L,R,q,B,N,V,D,E,M,O]),"main-header":n(()=>[a(o.$slots,"main-header")]),"main-header-after":n(()=>[a(o.$slots,"main-header-after")]),"main-nav":n(()=>[a(o.$slots,"main-nav")]),"main-content":n(()=>[a(o.$slots,"main-content")]),"main-content-after":n(()=>[a(o.$slots,"main-content-after")]),"main-nav-before":n(()=>[a(o.$slots,"main-nav-before")]),"main-nav-after":n(()=>[a(o.$slots,"main-nav-after")]),comment:n(()=>[a(o.$slots,"comment")]),footer:n(()=>[a(o.$slots,"footer")]),aside:n(()=>[a(o.$slots,"aside")]),"aside-custom":n(()=>[a(o.$slots,"aside-custom")]),default:n(()=>[a(o.$slots,"default")]),_:3},8,["frontmatter"])}}};export{ee as default};
